<!DOCTYPE html>
<html>
<head>
<title>Crashing Page</title>
<style>
  body { font-family: sans-serif; }
</style>
</head>
<body>
  <h1>Crashing page</h1>
  <p>This page attempts to crash the browser tab by consuming memory in a loop.</p>
  <p>If crash recovery (like reloading) is implemented, this page might enter an infinite reload loop.</p>
  <script>
    console.log("Starting memory allocation loop...");
    let buffer = [];
    let counter = 0;
    const allocationSizeMB = 50;
    const interval = 10; // ms
    let intervalId = null;

    function allocate() {
      try {
        buffer.push(new Uint8Array(allocationSizeMB * 1024 * 1024));
        counter++;
        // console.log(`Allocated ${counter} times`);
      } catch (e) {
        console.error("Error allocating memory:", e);
        // If allocation fails (e.g., JS heap limit reached),
        // clear interval to prevent console spam.
        if (intervalId) {
          clearInterval(intervalId);
          intervalId = null;
          console.log(`Stopped allocation after ${counter} successful allocations.`);
        }
      }
    }

    window.addEventListener('load', () => {
      intervalId = setInterval(allocate, interval);
    });
  </script>
</body>
</html>